# Generated by Django 3.1 on 2020-09-29 07:32

from django.db import migrations, models


def migrate_cost_price(apps, schema_editor):
    ProductVariantChannelListing = apps.get_model(
        "product", "ProductVariantChannelListing"
    )

    for product_variant_listing in ProductVariantChannelListing.objects.iterator():
        product_variant = product_variant_listing.variant
        product_variant_listing.cost_price_amount = product_variant.cost_price_amount
        product_variant_listing.save(update_fields=["cost_price_amount"])


class Migration(migrations.Migration):

    dependencies = [
        ("product", "0131_auto_20200910_1000"),
    ]

    operations = [
        migrations.AddField(
            model_name="productvariantchannellisting",
            name="cost_price_amount",
            field=models.DecimalField(
                blank=True, decimal_places=3, max_digits=12, null=True
            ),
        ),
        migrations.RunPython(migrate_cost_price, migrations.RunPython.noop),
        migrations.RemoveField(model_name="productvariant", name="cost_price_amount",),
        migrations.RemoveField(model_name="productvariant", name="currency",),
    ]
